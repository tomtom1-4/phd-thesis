% !TEX encoding = UTF-8
% !TEX TS-program = pdflatex
% !TEX root = ../thesis.tex

%************************************************
\chapter{Computational Details}\label{chap:5:computational_details}
%************************************************

Our final goal is clear now: We want to investigate the effect of finite top- and bottom-quark masses on the Higgs production cross section, both on the inclusive and the differential cross section level. In particular, we want to study the impact of the mass renormalization scheme on the cross section to eliminate one of the main remaining uncertainties of the cross section. Furthermore, in addition to the commonly used 5\acs{FS}, we want to explore the impact of alternative \acs{FS}s to assess the validity of the treatment of light quark masses in the 5\acs{FS}.

In this chapter, we will describe the necessary methods for computing the Higgs production cross section with full top- and bottom-quark mass dependence at \acs{NNLO}.

\section{Computing the Amplitudes}
The base ingredients of the calculation are the scattering amplitudes. In addition to the \acs{LO} amplitude for $gg \rightarrow H$ presented in section~\ref{sec:4:LO_xSec} and the \acs{NLO} amplitudes computed in Ref.~\cite{Graudenz:1992pv}, we require amplitudes for the following partonic processes
\begin{itemize}
  \item Real-Real Corrections (One-loop):
  \begin{enumerate}
    \item $gg \rightarrow H gg$
    \item $gg \rightarrow H q \bar{q}$
    \item $q\bar{q} \rightarrow H q^\prime \bar{q}^\prime$
    \item + processes related by crossing symmetry
  \end{enumerate}
  \item Real-Virtual Amplitudes (Two-loop):
  \begin{enumerate}
    \item $gg \rightarrow Hg$
    \item $q \bar{q} \rightarrow H g$
    \item + processes related by crossing symmetry
  \end{enumerate}
  \item Virtual-Virtual Amplitudes (Three-loop):
  \begin{enumerate}
    \item $g g \rightarrow H$.
  \end{enumerate}
\end{itemize}
In the following, we discuss the computation of each element one-by-one.

In this section, we are exclusively working in the 5\acs{FS}. The necessary modifications for adapting the amplitudes to the 4\acs{FS} will be presented in section~\ref{sec:5:4FS}. When working in the 5\acs{FS}, the bottom-quark mass is generally zero. Since this would imply that the total top-bottom interference contribution is vanishing, one then sets the mass to its actual value inside all closed quark loops that couple to the Higgs. Therefore in Feynman diagrams like those depicted in Fig.~\ref{fig:5:real_virtual2}, the bottom quark is treated as massive, but if the top- and bottom-quark are exchanged, the bottom quark mass is set to zero. With a massification prescription like this, it is essential to verify that gauge invariance and \acs{IR} safety are not lost in the process.

The proof that it is not proceeds by the replica technique. Consider the \acs{SM} but only with the following quark content: $n_b$ identical copies of the bottom quark, $n_{b^\prime}$ massless quarks $b^\prime$ serving as our massless bottom quark, and the top-quark. Without the inclusion of electroweak effects this theory is equivalent to \acs{QCD} with the addition of a Yukawa interaction to the Higgs; ergo this theory is gauge invariant and free of \acs{IR}-divergences. Furthermore, gauge invariance and \acs{IR}-safety also hold for each individual Yukawa coupling contribution ($Y_t$ or $Y_b$) and each power of $n_b$ and $n_{b^\prime}$, as these are arbitrary parameters from the point of \acs{QCD}. This means that the parts of the amplitude which are proportional to $Y_t n_b$ are separately gauge invariant, and so are the parts which are proportional to $Y_b n_b n_{b^\prime}$, and so on. Examples of Feynman diagrams contributing to a selection of $Y_t$, $Y_b$, $n_b$ and $n_{b^\prime}$ power-combinations are depicted in Fig.~\ref{fig:5:replica}.
\begin{figure}[h]
\centering
\includegraphics[scale=0.3]{Images/NNLO_Feynman_diagrams/replica.pdf}
\caption{Example Feynman diagrams and their scaling with the Yukawa coupling, $n_b$, and $n_{b^\prime}$.}
\label{fig:5:replica}
\end{figure}
Likewise, after squaring, the contribution $Y_t Y_b n_{b^\prime} n_{b}$ is going to be separately \acs{IR} finite. We have thus shown, that contributions with a massive bottom-quark loop which does \textbf{not} couple to the Higgs does not mix gauge dependent terms or \acs{IR} divergences with the selected contribution from our massification procedure.

\subsection{The Real-Real Corrections}
The real-real corrections only contain a single loop, with either a top or a bottom quark running in the loop. Examples of different Feynman diagrams for various partonic channels are depicted in Fig.~\ref{fig:5:real_real}.
\begin{figure}[h]
  \centering
  \includegraphics[width=\figurewidth]{Images/NNLO_Feynman_diagrams/RealReal.pdf}
  \caption{Example Feynman diagrams for one-loop real-real corrections in various partonic channels.}
  \label{fig:5:real_real}
\end{figure}

As one-loop amplitudes, they can be computed numerically with publically available libraries like \texttt{Recola}~\cite{Actis:2016mpe}. However, the real-real corrections often represent the bottleneck of the computation of the phase-space integrals, which makes an efficient evaluation of the amplitudes desirable. We therefore instead use the analytic form of the amplitude computed in Ref.~\cite{Budge:2020oyl}. We use the implementation of the amplitudes provided by \texttt{MCFM}~\cite{Campbell:2019dru, Campbell:1999ah, Campbell:2011bn}, which in turn uses \texttt{QCDLoop}~\cite{Ellis:2007qk, Carrazza:2016gav} for the evaluation of one-loop integrals.

We found that with the analytic expressions, the evaluation time of the amplitudes is sped up by a factor of 20 compared to the numerical evaluation in \texttt{Recola}.

\subsection{The Real-Virtual Corrections}
For the real-virtual corrections we, for the first time encounter Feynman diagrams with two different mass scales running in the loop. Fig.~\ref{fig:5:real_virtual2} shows all (up to inversion of the fermion flow inside the triangle loops) Feynman diagrams with two internal quark loops.
\begin{figure}[h]
  \centering
  \includegraphics[scale=0.5]{Images/NNLO_Feynman_diagrams/RealVirtual2.pdf}
  \caption{Feynman diagrams for the two-loop real-virtual corrections with two massive quarks. Amplitudes for the $qg \rightarrow Hq$ channel can be obtained via crossing from the $q \bar{q} \rightarrow H g$ amplitudes.Triangle loops with reversed fermion flow are not explicitly shown. In the 5\acs{FS}, the bottom-quark is always coupling to the Higgs.}
  \label{fig:5:real_virtual2}
\end{figure}
We observe, that all two-loop integrals actually factorize into two separate one-loop integrals making them quite straight-forward to solve.

The contributions to the scattering amplitude containing only a single massive quark involve genuine two-loop integrals. Fig.~\ref{fig:5:real_virtual1} shows a selection of contributing Feynman diagrams.
\begin{figure}[h]
  \centering
  \includegraphics[width=\figurewidth]{Images/NNLO_Feynman_diagrams/RealVirtual1.pdf}
  \caption{Example Feynman diagrams for the two-loop real-virtual corrections with a single massive quark in various partonic channels.}
  \label{fig:5:real_virtual1}
\end{figure}
Two loop integrals, especially non-planar ones, with three mass scales are very challenging to compute analytically, even with state-of-the-art methods, and as of today the analytic computation of these amplitudes are still unknown, however approximations for a nearly massless bottom quark have been calculated relatively recently~\cite{Melnikov:2016qoc, Melnikov:2017pgf}. We therefore decided to instead evaluate the appearing two-loop integrals numerically at fixed phase-space points and interpolate between them during the phase-space integration.

In any case, for both the one-mass and two-masses contribution we first have to reduce the amplitude to form factors. To make possible symmetries more apparent, we cross the radiated parton to the initial state, \ie\ we consider the amplitudes
\begin{equation}
g(p_1) + g_(p_2) + g(p_3) \longrightarrow H(p_4), \qquad \bar{q}(p_1) + q(p_2) + g(p_3) \longrightarrow H(p_4).
\end{equation}

\textbf{Projection to Form Factors}\\
We can factor out the external polarization vectors, spinors and color factors to rewrite the amplitudes in terms of their amputated counterpart
\begin{equation}
\mathcal{M}_{ggg \rightarrow H} = \mathcal{M}_{\mu \nu \rho} \epsilon_1^\mu \epsilon_2^\nu \epsilon_3^\rho f^{c_1 c_2 c_3}, \qquad \mathcal{M}_{\bar{q} q g \rightarrow H} = \bar{v}(p_1) \mathcal{M}_{\rho} u(p_2) \epsilon_3^\rho T^{c_3}_{c_1 c_2}.
\end{equation}
It is convenient, to choose polarization vectors which are cyclically transverse to the external gluon momenta, \ie\
\begin{equation}
\epsilon_1 = \epsilon (p_1; p_2), \quad \epsilon_2 = \epsilon (p_2; p_3), \quad \epsilon_3 = \epsilon (p_3; p_1),
\end{equation}
where the second argument indicates the gauge vector. We can then propose the form factor decomposition of the amplitudes
\begin{equation}
\begin{split}
\mathcal{M}^{\mu \nu \rho} &= g^{\mu \nu} p_2^\rho F_1 + g^{\mu \rho} p_1^\nu F_2 + g^{\nu \rho} p_3^\mu F_3 + p_3^\mu p_1^\nu p_2^\rho F_4, \\
\bar{v}(p_1) \mathcal{M}^{\rho} u(p_2) &= \bar{v}(p_1)\left[ \slashed{p}_3 p_1^\rho - (p_1 \cdot p_3) \gamma^\rho \right] u(p_2) G_1 + \bar{v}(p_1) \left[ \slashed{p}_3 p_2^\rho - (p_2 \cdot p_3) \gamma^\rho \right] u(p_2) G_2.
\end{split}
\end{equation}
We used the Ward identity, to restrict the tensor coefficients in $\mathcal{M}^\rho$. $\mathcal{M}^{\mu \nu \rho}$ also satisfies Ward identity.

The tensor coefficients span a vector space with respect to the scalar product
\begin{equation}
\braket{a_{\mu_1, \cdots \mu_{n_g}}| b^{\mu_1, \cdots \mu_{n_g}}} \equiv \sum_{\text{pol.}} a^*_{\mu_1 \ldots \mu_{n_g}} \left[\prod_i^{n_g} \epsilon_i^{*\mu_i} \epsilon_i^{\nu_i}  \right]  b_{\nu_1 \ldots \nu_{n_g}}
\label{eq:5:scala_product}
\end{equation}
where $n_g$ is the number of external gluons, \ie $n_g = 3$ for $ggg \rightarrow H$ and $n_g = 1$ for $\bar{q} q g \rightarrow H$ and the summation is performed over the polarizations of all external particles. The tensor coefficients hence form a---not necessary orthonormal---basis.

Any vector can be written as a linear sum over basis vectors
\begin{equation}
\ket{v} = \sum_i v_i \ket{e_i}.
\end{equation}
Then the projector to the $j$-th basis vector can be found via
\begin{equation}
\bra{e_j}P \equiv P_j = \sum_k G^{-1}_{jk} \ket{e_k},
\end{equation}
where $G$ is the Gram-matrix
\begin{equation}
G_{ij} = \braket{e_i | e_j}.
\end{equation}

With this little interlude from linear algebra it is then easy to verify that the projectors for the $F_1,\ldots , F_4$ form factors are given by
\begin{equation}
\begin{split}
P_1^{\mu \nu \rho} &= \frac{1}{d - 3} \left( g^{\mu \nu} p_2^\rho \frac{t}{su} - p_3^\mu p_1^\nu p_2^\rho \frac{1}{su} \right), \\
P_2^{\mu \nu \rho} &= \frac{1}{d - 3} \left( g^{\mu \rho} p_1^\nu \frac{u}{s t} - p_3^\mu p_1^\nu p_2^\rho \frac{1}{st} \right), \\
P_3^{\mu \nu \rho} &= \frac{1}{d - 3} \left( g^{\nu \rho} p_3^\mu \frac{s}{t u} - p_3^\mu p_1^\nu p_2^\rho \frac{1}{t u} \right), \\
P_4^{\mu \nu \rho} &= \frac{1}{d - 3} \left( - g^{\mu \nu} p_2^\rho \frac{1}{s u} - g^{\mu \rho} p_1^\nu \frac{1}{s t} - g^{\nu \rho} p_3^\mu \frac{1}{t u} + p_3^\mu p_1^\nu p_2^\rho \frac{d}{s t u} \right).
\end{split}
\end{equation}
To be even more explicit: the form factors are given by
\begin{equation}
\begin{split}
&F_i = \braket{e_i| P_{\mu \nu \rho} | \mathcal{M}^{\mu \nu \rho}} = P_i^{\mu_1 \nu_1 \rho_1} \left(-g_{\mu_1 \mu_2} + \frac{p_{1\, \mu_1} p_{2\, \mu_2} + p_{2\, \mu_1} p_{1\, \mu_2}}{p_1 \cdot p_2} \right) \\
& \qquad \times \left(-g_{\nu_1 \nu_2} + \frac{p_{2\, \nu_1} p_{3\, \nu_2} + p_{3\, \nu_1} p_{2\, \nu_2}}{p_2 \cdot p_3} \right) \left(-g_{\rho_1 \rho_2} + \frac{p_{3\, \rho_1} p_{1\, \rho_2} + p_{1\, \rho_1} p_{3\, \rho_2}}{p_3 \cdot p_1} \right) \mathcal{M}^{\mu_2 \nu_2 \rho_2}.
\end{split}
\end{equation}
Here we used the standard identity
\begin{equation}
\sum_{\lambda} \epsilon^{*}_\mu (p, n, \lambda) \epsilon_\nu(p, n, \lambda) = -g_{\mu \nu} + \frac{p_\mu n_\nu + p_\nu n_\mu}{p \cdot n}
\end{equation}
to rewrite the sum over the polarization vectors.

Similarly, using
\begin{equation}
\sum_{\lambda} u(p, \lambda) \bar{u}(p, \lambda) = \slashed{p}, \quad \text{and} \quad \sum_\lambda v(p, \lambda) \bar{v}(p, \lambda) = \slashed{p},
\label{eq:5:spinor_polarization_sum}
\end{equation}
we find the projectors of $G_1$ and $G_2$\footnote{Note that the projectors are defined as the entire left-hand side.}
\begin{equation}
\begin{split}
\bar{v}(p_1) P_1^\mu u(p_2) &= \frac{1}{2 s t (d - 3)} \bar{v}(p_1) \left[ \frac{d - 2}{t} \left(\slashed{p}_3 p_1^\mu - \frac{t}{2} \gamma^\mu \right) - \frac{d - 4}{u} \left(\slashed{p}_3 p_2^\mu - \frac{u}{2} \gamma^\mu \right) \right]u(p_2), \\
\bar{v}(p_1) P_2^\mu u(p_2) &= \frac{1}{2 s u (d - 3)} \bar{v}(p_1) \left[ \frac{d - 2}{u} \left(\slashed{p}_3 p_2^\mu - \frac{u}{2} \gamma^\mu \right) - \frac{d - 4}{t} \left(\slashed{p}_3 p_1^\mu - \frac{t}{2} \gamma^\mu \right) \right] u(p_2). \\
\end{split}
\end{equation}
These allow the extraction of the form factors via
\begin{equation}
\begin{split}
G_i = \braket{e_i| P_\mu |\mathcal{M}^\mu} =  \left(-g_{\mu_1 \mu_2} + \frac{p_{3\, \mu_1} p_{1\, \mu_2} + p_{1\, \mu_1} p_{3\, \mu_2}}{p_3 \cdot p_1} \right) \text{tr} \big \lbrace P_i^{\mu_1} \mathcal{M}^{\mu_2} \big \rbrace,
\end{split}
\end{equation}
where we have used Eq.~\eqref{eq:5:spinor_polarization_sum} once again, to rewrite the polarization sum in terms of a Dirac-trace.

\textbf{Helicity Amplitudes} \\
Since the form factors dependent on the choice of our tensor basis, we would rather express our end result in terms of helicity amplitudes
\begin{equation}
\begin{split}
\mathcal{M}^{\lambda_1 \lambda_2 \lambda_3}_{ggg \rightarrow H} &= \mathcal{M}_{\mu \nu \rho} \epsilon^\mu(p1, p_2, \lambda_1) \epsilon_2^\nu(p_2, p_3, \lambda_2) \epsilon_3^\rho(p_3, p_1, \lambda_3), \\
\mathcal{M}^{\lambda_1 \lambda_2 \lambda_3}_{\bar{q}q g \rightarrow H} &= \bar{v}(p_1, \lambda_1/2) \mathcal{M}_{\rho} u(p_2, \lambda_2/2)  \epsilon_3^\rho(p_3, p_1, \lambda_3).
\end{split}
\end{equation}
To find the relation between the form factors and the helicity amplitudes, we consider all independent helicity configurations and use the \textit{spinor-helicity formalism} (see Ref.~\cite{Dixon:1996wi} for a pedagogical introduction to the topic) to rewrite them in terms of spinor products
\begin{equation}
\braket{ij} \equiv \bar{u}(p_i, -1/2) u(p_j, 1/2), \qquad [ij] \equiv \bar{u}(p_i, 1/2) u(p_j, -1/2).
\end{equation}
The results for the $ggg \rightarrow H$ amplitudes read
\begin{equation}
\begin{split}
\mathcal{M}_{ggg\rightarrow H}^{+++} &= \frac{1}{\sqrt{2}} \frac{s u}{\braket{12} \braket{23} \braket{31}} \left( F_1 + \frac{t}{u} F_2 + \frac{t}{s} F_3 + \frac{t}{2} F_4 \right), \\
\mathcal{M}_{ggg\rightarrow H}^{++-} &= \frac{1}{\sqrt{2}} \frac{[12]^3}{[13][23]} \frac{u}{s} \left(F_1 + \frac{t}{2} F_4 \right), \\
\mathcal{M}_{ggg\rightarrow H}^{+-+} &= \frac{1}{\sqrt{2}} \frac{[13]^3}{[12][23]} \frac{s}{t} \left(F_2 + \frac{u}{2} F_4 \right), \\
\mathcal{M}_{ggg\rightarrow H}^{-++} &= \frac{1}{\sqrt{2}} \frac{[23]^3}{[12][13]} \frac{t}{u} \left(F_3 + \frac{s}{2} F_4 \right).
\end{split}
\end{equation}
The other four helicity amplitudes can be determined via charge conjugation
\begin{equation}
\mathcal{M}^{\lambda_1, \lambda_2, \lambda_3} = \mathcal{M}^{-\lambda_1, - \lambda_2, -\lambda_3} \big \vert_{\braket{ij} \leftrightarrow [ji]}.
\label{eq:5:parity}
\end{equation}
Similarly, for the $\bar{q}q g \rightarrow H$ process we find the helicity amplitudes
\begin{equation}
\begin{split}
\mathcal{M}^{-++}_{\bar{q}q g \rightarrow H} &= - \frac{1}{\sqrt{2}} \frac{[13]^2}{[12]} s F_1, \\
\mathcal{M}^{+-+}_{\bar{q}q g \rightarrow H} &= \frac{1}{\sqrt{2}} \frac{[23]^2}{[12]} s F_2.
\end{split}
\end{equation}
The $+--$ and $-+-$ amplitudes can be determined with Eq.~\eqref{eq:5:parity} and all other helicity configurations render vanishing amplitudes due to the conservation of angular momentum.

\subsection{The Virtual-Virtual Corrections}
\section{\texorpdfstring{$\MS$}{MS}-scheme}
\section{The 4-Flavour Scheme}\label{sec:5:4FS}
\section{Performing the Phase-Space Integration}


