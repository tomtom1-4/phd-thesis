(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     11370,        321]
NotebookOptionsPosition[      9474,        279]
NotebookOutlinePosition[      9879,        295]
CellTagsIndexPosition[      9836,        292]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"y", "[", "x_", "]"}], ":=", "   ", 
  RowBox[{"a0", " ", "+", " ", 
   RowBox[{"a1", " ", "x"}], " ", "+", " ", 
   RowBox[{"a2", " ", 
    SuperscriptBox["x", "2"]}], " ", "+", " ", 
   RowBox[{"a3", " ", 
    SuperscriptBox["x", "3"], " "}]}]}]], "Input",
 CellChangeTimes->{{3.918094377149703*^9, 3.918094420863922*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"666bf48c-c852-47ef-94da-89edeccf1752"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"y", "'"}], "[", "x2", "]"}]], "Input",
 CellChangeTimes->{{3.9180946414246597`*^9, 3.918094646540914*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"d7d33701-bbd9-4aec-84c5-c4e404f44be4"],

Cell[BoxData[
 RowBox[{"a1", "+", 
  RowBox[{"2", " ", "a2", " ", "x2"}], "+", 
  RowBox[{"3", " ", "a3", " ", 
   SuperscriptBox["x2", "2"]}]}]], "Output",
 CellChangeTimes->{3.918094647281674*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"0191898f-68ac-4348-83f6-5757c67e8722"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D", "[", 
   RowBox[{
    RowBox[{"y", "[", "x", "]"}], ",", " ", "x"}], "]"}], "[", "x2", 
  "]"}]], "Input",
 CellChangeTimes->{{3.918094480784131*^9, 3.918094490901402*^9}, {
  3.918094565883913*^9, 3.918094618509589*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"6523da4b-992e-4d7b-b41c-9b91db368364"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"a1", "+", 
    RowBox[{"2", " ", "a2", " ", "x"}], "+", 
    RowBox[{"3", " ", "a3", " ", 
     SuperscriptBox["x", "2"]}]}], ")"}], "[", "x2", "]"}]], "Output",
 CellChangeTimes->{{3.918094484209059*^9, 3.918094491365527*^9}, {
  3.918094580455944*^9, 3.918094618949834*^9}},
 CellLabel->"Out[11]=",ExpressionUUID->"c90c2c7e-e13d-4a82-8867-d1cc87d5577e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"spline", " ", "=", " ", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"y1", " ", "\[Equal]", " ", 
      RowBox[{"y", "[", "x1", "]"}]}], "&&", " ", 
     RowBox[{"y2", " ", "==", " ", 
      RowBox[{"y", "[", "x2", "]"}]}], " ", "&&", " ", 
     RowBox[{"dy1", " ", "\[Equal]", 
      RowBox[{
       RowBox[{"y", "'"}], "[", "x1", "]"}]}], "&&", " ", 
     RowBox[{"dy2", " ", "\[Equal]", " ", 
      RowBox[{
       RowBox[{"y", "'"}], "[", "x2", "]"}]}]}], ",", " ", 
    RowBox[{"{", 
     RowBox[{"a0", ",", " ", "a1", ",", " ", "a2", ",", " ", "a3"}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.918094422735138*^9, 3.918094467590293*^9}, {
  3.9180945131280746`*^9, 3.9180945506379347`*^9}, {3.918094654384976*^9, 
  3.918094663957848*^9}, {3.918094743597237*^9, 3.918094748333755*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"7ede0f1d-56c7-4164-82d0-cb1719f7f91b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"a0", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "-", "x2"}], ")"}], "3"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dy2", " ", 
          SuperscriptBox["x1", "3"], " ", "x2"}], "+", 
         RowBox[{"dy1", " ", 
          SuperscriptBox["x1", "2"], " ", 
          SuperscriptBox["x2", "2"]}], "-", 
         RowBox[{"dy2", " ", 
          SuperscriptBox["x1", "2"], " ", 
          SuperscriptBox["x2", "2"]}], "-", 
         RowBox[{"dy1", " ", "x1", " ", 
          SuperscriptBox["x2", "3"]}], "-", 
         RowBox[{"3", " ", "x1", " ", 
          SuperscriptBox["x2", "2"], " ", "y1"}], "+", 
         RowBox[{
          SuperscriptBox["x2", "3"], " ", "y1"}], "-", 
         RowBox[{
          SuperscriptBox["x1", "3"], " ", "y2"}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["x1", "2"], " ", "x2", " ", "y2"}]}], ")"}]}]}]}], 
    ",", 
    RowBox[{"a1", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "-", "x2"}], ")"}], "3"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "dy2"}], " ", 
          SuperscriptBox["x1", "3"]}], "-", 
         RowBox[{"2", " ", "dy1", " ", 
          SuperscriptBox["x1", "2"], " ", "x2"}], "-", 
         RowBox[{"dy2", " ", 
          SuperscriptBox["x1", "2"], " ", "x2"}], "+", 
         RowBox[{"dy1", " ", "x1", " ", 
          SuperscriptBox["x2", "2"]}], "+", 
         RowBox[{"2", " ", "dy2", " ", "x1", " ", 
          SuperscriptBox["x2", "2"]}], "+", 
         RowBox[{"dy1", " ", 
          SuperscriptBox["x2", "3"]}], "+", 
         RowBox[{"6", " ", "x1", " ", "x2", " ", "y1"}], "-", 
         RowBox[{"6", " ", "x1", " ", "x2", " ", "y2"}]}], ")"}]}]}]}], ",", 
    RowBox[{"a2", "\[Rule]", 
     RowBox[{"-", 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"x1", "-", "x2"}], ")"}], "3"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"dy1", " ", 
          SuperscriptBox["x1", "2"]}], "+", 
         RowBox[{"2", " ", "dy2", " ", 
          SuperscriptBox["x1", "2"]}], "+", 
         RowBox[{"dy1", " ", "x1", " ", "x2"}], "-", 
         RowBox[{"dy2", " ", "x1", " ", "x2"}], "-", 
         RowBox[{"2", " ", "dy1", " ", 
          SuperscriptBox["x2", "2"]}], "-", 
         RowBox[{"dy2", " ", 
          SuperscriptBox["x2", "2"]}], "-", 
         RowBox[{"3", " ", "x1", " ", "y1"}], "-", 
         RowBox[{"3", " ", "x2", " ", "y1"}], "+", 
         RowBox[{"3", " ", "x1", " ", "y2"}], "+", 
         RowBox[{"3", " ", "x2", " ", "y2"}]}], ")"}]}]}]}], ",", 
    RowBox[{"a3", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", "dy1"}], " ", "x1"}], "-", 
        RowBox[{"dy2", " ", "x1"}], "+", 
        RowBox[{"dy1", " ", "x2"}], "+", 
        RowBox[{"dy2", " ", "x2"}], "+", 
        RowBox[{"2", " ", "y1"}], "-", 
        RowBox[{"2", " ", "y2"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"x1", "-", "x2"}], ")"}], "3"]]}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.918094468406805*^9, 3.918094573014241*^9, 3.918094665822863*^9, {
   3.918094745073505*^9, 3.918094748700883*^9}},
 CellLabel->"Out[15]=",ExpressionUUID->"e2e96515-f6d8-42d2-abfa-20431ecf3682"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"a0", " ", "/.", 
   RowBox[{"spline", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.91809475516807*^9, 3.918094768165414*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"717a98f4-a3f1-4669-bc7b-9c628777da3a"],

Cell["\<\
-((dy2*Power(x1,3)*x2 + dy1*Power(x1,2)*Power(x2,2) - 
       dy2*Power(x1,2)*Power(x2,2) - dy1*x1*Power(x2,3) - 
       3*x1*Power(x2,2)*y1 + Power(x2,3)*y1 - Power(x1,3)*y2 + 
       3*Power(x1,2)*x2*y2)/Power(x1 - x2,3))\
\>", "Output",
 CellChangeTimes->{{3.918094762484448*^9, 3.918094768579698*^9}},
 CellLabel->
  "Out[17]//CForm=",ExpressionUUID->"3ca2328f-959c-4eec-80c8-0c960ed454c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"a1", " ", "/.", 
   RowBox[{"spline", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.918094839173161*^9, 3.9180948394210367`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"5c637141-3415-40ba-9ac5-a8c3cd7c94cc"],

Cell["\<\
-((-(dy2*Power(x1,3)) - 2*dy1*Power(x1,2)*x2 - 
       dy2*Power(x1,2)*x2 + dy1*x1*Power(x2,2) + 
       2*dy2*x1*Power(x2,2) + dy1*Power(x2,3) + 6*x1*x2*y1 - 
       6*x1*x2*y2)/Power(x1 - x2,3))\
\>", "Output",
 CellChangeTimes->{3.91809484018554*^9},
 CellLabel->
  "Out[18]//CForm=",ExpressionUUID->"e69bcfe2-b74a-4c5c-bfef-b6a6198220b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"a2", " ", "/.", 
   RowBox[{"spline", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9180948487170477`*^9, 3.918094848908824*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"c3a9111e-5b83-4940-aa5f-f56ce64f4faf"],

Cell["\<\
-((dy1*Power(x1,2) + 2*dy2*Power(x1,2) + dy1*x1*x2 - dy2*x1*x2 - 
       2*dy1*Power(x2,2) - dy2*Power(x2,2) - 3*x1*y1 - 3*x2*y1 + 
       3*x1*y2 + 3*x2*y2)/Power(x1 - x2,3))\
\>", "Output",
 CellChangeTimes->{3.918094850087536*^9},
 CellLabel->
  "Out[19]//CForm=",ExpressionUUID->"9d03e7b7-ac83-4150-bab1-783051174010"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CForm", "[", 
  RowBox[{"a3", " ", "/.", 
   RowBox[{"spline", "[", 
    RowBox[{"[", "1", "]"}], "]"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.9180948520214148`*^9, 3.918094852412936*^9}},
 CellLabel->"In[20]:=",ExpressionUUID->"7152dc52-2d5d-4925-9d59-e5b1a92750b7"],

Cell["\<\
-((-(dy1*x1) - dy2*x1 + dy1*x2 + dy2*x2 + 2*y1 - 2*y2)/
     Power(x1 - x2,3))\
\>", "Output",
 CellChangeTimes->{3.91809485296749*^9},
 CellLabel->
  "Out[20]//CForm=",ExpressionUUID->"b176235d-9234-4d81-a10c-5ccaa8410d48"]
}, Open  ]]
},
WindowSize->{606., 683.25},
WindowMargins->{{Automatic, 140.25}, {Automatic, 187.5}},
FrontEndVersion->"12.2 for Linux x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"1ae78f66-7697-41fe-aaa7-ce7a46d79aef"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 436, 10, 29, "Input",ExpressionUUID->"666bf48c-c852-47ef-94da-89edeccf1752"],
Cell[CellGroupData[{
Cell[1019, 34, 220, 4, 29, "Input",ExpressionUUID->"d7d33701-bbd9-4aec-84c5-c4e404f44be4"],
Cell[1242, 40, 277, 6, 33, "Output",ExpressionUUID->"0191898f-68ac-4348-83f6-5757c67e8722"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1556, 51, 339, 8, 29, "Input",ExpressionUUID->"6523da4b-992e-4d7b-b41c-9b91db368364"],
Cell[1898, 61, 407, 9, 36, "Output",ExpressionUUID->"c90c2c7e-e13d-4a82-8867-d1cc87d5577e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2342, 75, 925, 21, 71, "Input",ExpressionUUID->"7ede0f1d-56c7-4164-82d0-cb1719f7f91b"],
Cell[3270, 98, 3533, 97, 238, "Output",ExpressionUUID->"e2e96515-f6d8-42d2-abfa-20431ecf3682"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6840, 200, 291, 6, 29, "Input",ExpressionUUID->"717a98f4-a3f1-4669-bc7b-9c628777da3a"],
Cell[7134, 208, 404, 8, 102, "Output",ExpressionUUID->"3ca2328f-959c-4eec-80c8-0c960ed454c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7575, 221, 294, 6, 29, "Input",ExpressionUUID->"5c637141-3415-40ba-9ac5-a8c3cd7c94cc"],
Cell[7872, 229, 352, 8, 102, "Output",ExpressionUUID->"e69bcfe2-b74a-4c5c-bfef-b6a6198220b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8261, 242, 294, 6, 29, "Input",ExpressionUUID->"c3a9111e-5b83-4940-aa5f-f56ce64f4faf"],
Cell[8558, 250, 332, 7, 84, "Output",ExpressionUUID->"9d03e7b7-ac83-4150-bab1-783051174010"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8927, 262, 294, 6, 29, "Input",ExpressionUUID->"7152dc52-2d5d-4925-9d59-e5b1a92750b7"],
Cell[9224, 270, 234, 6, 66, "Output",ExpressionUUID->"b176235d-9234-4d81-a10c-5ccaa8410d48"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

